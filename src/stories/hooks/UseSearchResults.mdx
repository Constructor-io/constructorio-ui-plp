import { Meta, Canvas, Story, Controls, Source } from '@storybook/blocks';
import { Markdown } from '@storybook/blocks';
import meta, { Primary } from './UseSearchResults.stories';

<Meta of={meta} />

# `UseSearchResults`
A React Hook to retrieve search results using Constructor.

## Usage with useCioClient
```jsx
function myApp() {
  const cioClient = useCioClient(MY_API_KEY)
  const searchResults = useSearchResults(query, { cioClient });
  ...
}
```

## Usage with PlpContextProvider
```jsx
function SearchResults({ query }) {
  const searchResults = useSearchResults(query);
  ...
}

function myApp() {
  ...
  return (
    <>
    <PlpContextProvider apiKey={MY_API_KEY}>
      <SearchResults query={query} />
    </PlpContextProvider>
    </>
  )
}
```


## Working Example
This is an example of how you might utilize the `useSearchResults` hook in tandem with the `PlpContextProvider` to retrieve search results.

<Canvas source={{code: 'whatever you want to display'}} >
  <Story of={Primary} />
</Canvas>

<Controls of={Primary} />

### Working Example - Source Code 
```jsx
  import React from 'react';
  import { PlpContextProvider } from '../../PlpContext';
  import useSearchResults from '../../hooks/useSearchResults';

  const apiKey = 'MY_API_KEY'

  // A simple React Component to showcase useSearchResults with PlpContextProvider
  function SearchResults({ query }) {
    const searchParams = useMemo(() => ({ resultsPerPage: 2 }), []);
    const searchResults = useSearchResults(query, { searchParams });

    return (
      <>
        <h2>Result Id </h2>
        <div>{JSON.stringify(searchResults?.resultId)}</div>
        <h2>Total Number of Results </h2>
        <div>{JSON.stringify(searchResults?.totalNumResults)}</div>
        <h2>Array of Groups</h2>
        <div>{JSON.stringify(searchResults?.groups)}</div>
        <h2>Array of Facets</h2>
        <div>{JSON.stringify(searchResults?.facets)}</div>
        <h2>Array of Sort Options</h2>
        <div>{JSON.stringify(searchResults?.sortOptions)}</div>
        <h2>Array of Results</h2>
        <div>{JSON.stringify(searchResults?.results)}</div>
      </>
    );
  }

  // Main Component
  function useSearchResultsExample() {
    const [query] = useState('water')

    return (
      <>
        <h1>useSearchResults</h1>
        <p>This hook returns an object with the following properties:</p>
        <PlpContextProvider apiKey={MY_API_KEY}>
          <SearchResults query={query} />
        </PlpContextProvider>
      </>
    );
  }
```