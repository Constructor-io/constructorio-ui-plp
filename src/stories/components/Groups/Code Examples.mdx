import { Meta, Canvas, Markdown } from '@storybook/blocks';
import * as GroupsStories from './Groups.stories';
import UseGroupsReturn from '../../hooks/UseGroups/UseGroupsReturn.md?raw';
/* This "?raw" import raw text form the md file */

<Meta of={GroupsStories} />

# `Groups`

A separate filter component that allows you to filter down by groups.

> Note: In Constructor, groups are typically categories and are created via the `item_groups.csv` feed.

**Dynamic Hierarchical Options Rendering:**

- Automatically updates and displays selected filters based on user requests
- Displays the current selected group hierarchy, and allows for backward navigation

<Canvas of={GroupsStories.Primary} />

## Basic example

```jsx
import { CioPlp, Groups } from '@constructor-io/constructorio-ui-plp';
import '@constructor-io/constructorio-ui-plp/styles.css';

const DEMO_API_KEY = 'key_M57QS8SMPdLdLx4x';

const DEMO_GROUPS = [
  {
    groupId: '1',
    displayName: 'All',
    count: 250,
    data: null,
    children: [
      {
        groupId: '11',
        displayName: 'Greeting Cards',
        count: 250,
        data: null,
        children: [
          {
            groupId: '111',
            displayName: 'Halloween Greeting Cards',
            count: 100,
            data: null,
            children: [],
            parents: [
              {
                displayName: 'All',
                groupId: '1',
              },
              {
                displayName: 'Greeting Cards',
                groupId: '11',
              },
            ],
          },
          {
            groupId: '112',
            displayName: 'Christmas Greeting Cards',
            count: 150,
            data: null,
            children: [],
            parents: [
              {
                displayName: 'All',
                groupId: '1',
              },
              {
                displayName: 'Greeting Cards',
                groupId: '11',
              },
            ],
          },
        ],
        parents: [
          {
            displayName: 'All',
            groupId: '1',
          },
        ],
      },
    ],
  },
];

export default function MyComponent() {
  return (
    <CioPlp apiKey={DEMO_API_KEY}>
      <Groups groups={DEMO_GROUPS} />
    </CioPlp>
  );
}
```

## Render Props pattern

To override the default rendering of the Groups component, you may pass a Render Props function to the component.

```jsx
import { CioPlp, Groups } from '@constructor-io/constructorio-ui-plp';
import '@constructor-io/constructorio-ui-plp/styles.css';

const DEMO_API_KEY = 'key_M57QS8SMPdLdLx4x';

const DEMO_GROUPS = [
  {
    groupId: '1',
    displayName: 'All',
    count: 250,
    data: null,
    children: [
      {
        groupId: '11',
        displayName: 'Greeting Cards',
        count: 250,
        data: null,
        children: [
          {
            groupId: '111',
            displayName: 'Halloween Greeting Cards',
            count: 100,
            data: null,
            children: [],
            parents: [
              {
                displayName: 'All',
                groupId: '1',
              },
              {
                displayName: 'Greeting Cards',
                groupId: '11',
              },
            ],
          },
          {
            groupId: '112',
            displayName: 'Christmas Greeting Cards',
            count: 150,
            data: null,
            children: [],
            parents: [
              {
                displayName: 'All',
                groupId: '1',
              },
              {
                displayName: 'Greeting Cards',
                groupId: '11',
              },
            ],
          },
        ],
        parents: [
          {
            displayName: 'All',
            groupId: '1',
          },
        ],
      },
    ],
  },
];

function MyCustomGroups(props) {
  const {
    groupOptions,
    currentGroupId,
    currentPage,
    initialNumOptions,
    isShowAll,
    optionsToRender,
  } = props;

  const renderGroup = (group, depth = 0) => {
    const hasChildren = group.children && group.children.length > 0;

    return (
      <div key={group.groupId}>
        <div>
          Depth: {depth}: {group.displayName} <span>({group.count})</span>
        </div>

        {hasChildren && <div>{group.children.map((child) => renderGroup(child, depth + 1))}</div>}
      </div>
    );
  };

  return (
    <>
      <h2>Custom Group Filters</h2>
      <p>Current Page: {currentPage}</p>
      <div>{groupOptions.map((group) => renderGroup(group))}</div>
    </>
  );
}

export default function MyComponent() {
  return (
    <CioPlp apiKey={DEMO_API_KEY}>
      <Groups groups={DEMO_GROUPS}>
        {(props) => {
          return <MyCustomGroups {...props} />;
        }}
      </Groups>
    </CioPlp>
  );
}
```

### Arguments passed to children via Render Props

> Accessible to children of the Filters component via render props.

`UseGroupReturn`

<Markdown>{UseGroupsReturn}</Markdown>
