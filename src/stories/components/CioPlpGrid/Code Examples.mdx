import { Meta, Canvas, Markdown } from '@storybook/blocks';
import * as CioPlpGridStories from './CioPlpGrid.stories';
import RenderProps from './RenderProps.md?raw';
/* This "?raw" import raw text form the md file */

<Meta of={CioPlpGridStories} name='Code Examples' />

# `CioPlpGrid`

The CioPlpGrid component is a dynamic and user-friendly component
It is responsible for displaying the results based on user's actions

**Dynamic Result Rendering:**

- Automatically updates and displays results based on user queries
- Handles data fetching from the API

**User-Friendly Interface**:

- Presents data in a clear and accessible layout.
- Includes key details for each result, such as titles, descriptions, prices, swatches and images

**Pagination and Scrolling:**

- Implements pagination for handling large sets of results

**Spinner indicator:**

- It will show a Spinner while fetching data. You can customize it by passing a custom component

**Interactive Elements:**

- Allows users to interact with the results (e.g., Add to cart)

**No Results Handling:**

- Gracefully manages scenarios with no results
- Displays a user-friendly message indicating the absence of results

**Performance Optimization:**

- Optimized for quick rendering and updating of results
- Ensures smooth performance, even with large datasets or real-time requirements

<Canvas of={CioPlpGridStories.Primary} />

## Basic example

To view the examples and see this component in action
  - **Search** - append your URL with `?q=shirt`
  - **Browse** - append your URL with `/group_id/1035`

```jsx
import { CioPlp, CioPlpGrid } from "@constructor-io/constructorio-ui-plp";
import "@constructor-io/constructorio-ui-plp/styles.css";

const DEMO_API_KEY = "key_M57QS8SMPdLdLx4x";

export default function MyComponent() {
  return (
    <CioPlp apiKey={DEMO_API_KEY}>
      <CioPlpGrid />
    </CioPlp>
  );
}
```

## Groups Configuration (`groupsConfigs`)

The CioPlpGrid component supports configuring the Groups component behavior through the `groupsConfigs` prop. This allows you to customize how product categories are displayed and interacted with.

### Custom Groups Configuration

Configure groups with limited initial options and custom title:

<Canvas of={CioPlpGridStories.CustomGroupsConfig} />

```jsx
import { CioPlp, CioPlpGrid } from "@constructor-io/constructorio-ui-plp";
import "@constructor-io/constructorio-ui-plp/styles.css";

const DEMO_API_KEY = "key_M57QS8SMPdLdLx4x";

export default function MyComponent() {
  return (
    <CioPlp apiKey={DEMO_API_KEY}>
      <CioPlpGrid
        groupsConfigs={{
          initialNumOptions: 3,        // Show only 3 options initially
          title: 'Product Categories', // Custom section title
          isCollapsed: false          // Start expanded
        }}
      />
    </CioPlp>
  );
}
```

### Collapsed Groups

Start with the groups section collapsed to save space:

<Canvas of={CioPlpGridStories.CollapsedGroups} />

```jsx
export default function MyComponent() {
  return (
    <CioPlp apiKey={DEMO_API_KEY}>
      <CioPlpGrid
        groupsConfigs={{
          isCollapsed: true,           // Start collapsed
          title: 'Browse Categories'   // Custom title
        }}
      />
    </CioPlp>
  );
}
```

### Hidden Groups

Completely hide the groups section when not needed:

<Canvas of={CioPlpGridStories.HiddenGroups} />

```jsx
export default function MyComponent() {
  return (
    <CioPlp apiKey={DEMO_API_KEY}>
      <CioPlpGrid
        groupsConfigs={{
          hideGroups: true  // Hide groups entirely
        }}
      />
    </CioPlp>
  );
}
```

### All Available groupsConfigs Options

Here's a comprehensive example showing all available configuration options:

```jsx
export default function MyComponent() {
  return (
    <CioPlp apiKey={DEMO_API_KEY}>
      <CioPlpGrid
        groupsConfigs={{
          // Number of group options to show initially (default: 5)
          // Remaining options are hidden under "Show All" button
          initialNumOptions: 4,

          // Whether the groups section starts collapsed (default: false)
          isCollapsed: false,

          // Custom title for the groups section (default: "Categories")
          title: 'Shop by Category',

          // Whether to hide the groups component entirely (default: false)
          hideGroups: false
        }}
      />
    </CioPlp>
  );
}
```

### Responsive Groups Configuration

You can also conditionally configure groups based on screen size or other factors:

```jsx
import { useState, useEffect } from 'react';

export default function MyComponent() {
  const [isMobile, setIsMobile] = useState(false);

  useEffect(() => {
    const checkMobile = () => setIsMobile(window.innerWidth < 768);
    checkMobile();
    window.addEventListener('resize', checkMobile);
    return () => window.removeEventListener('resize', checkMobile);
  }, []);

  return (
    <CioPlp apiKey={DEMO_API_KEY}>
      <CioPlpGrid
        groupsConfigs={{
          // Show fewer options on mobile
          initialNumOptions: isMobile ? 2 : 5,
          // Start collapsed on mobile to save space
          isCollapsed: isMobile,
          title: 'Categories'
        }}
      />
    </CioPlp>
  );
}
```

## Render Props pattern

If you prefer to handle the rendering of the CioPlpGrid component, you may pass a Render Props function to the component.

```jsx
import { CioPlp, CioPlpGrid } from "@constructor-io/constructorio-ui-plp";
import "@constructor-io/constructorio-ui-plp/styles.css";

const DEMO_API_KEY = "key_M57QS8SMPdLdLx4x";

function MyCustomPlpGrid(props) {
  const { status, data, refetch, sort, filters, groups, pagination } = props;

  return <>{/* CUSTOM_MARKUP_HERE */}</>;
}

export default function MyComponent() {
  return (
    <CioPlp apiKey={DEMO_API_KEY}>
      <CioPlpGrid>
        {(props) => {
          return <MyCustomPlpGrid {...props} />;
        }}
      </CioPlpGrid>
    </CioPlp>
  );
}
```

For a working example, visit our Code Sandbox:

- <a href='https://codesandbox.io/p/sandbox/constructorio-ui-plp-customization-example-sgdgkl?file=%2Fsrc%2Fcomponents%2FCustomCioPlp.js' target='_blank' rel='noopener noreferrer'> Code Sandbox Example - Custom Render <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-up-right-icon lucide-arrow-up-right"><path d="M7 7h10v10"/><path d="M7 17 17 7"/></svg></a>

### Arguments passed to children via Render Props

> Accessible to children of the CioPlpGrid component via render props.

<Markdown>{RenderProps}</Markdown>
